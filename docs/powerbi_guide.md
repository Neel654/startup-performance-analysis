# Power BI Integration Guide
## Startup Performance Analysis Tool

---

## ğŸ“Š Overview

This guide walks you through connecting your processed startup analytics data to Power BI for interactive visualization and business intelligence dashboards.

---

## ğŸ”§ Prerequisites

- **Power BI Desktop** (latest version)
- **PostgreSQL ODBC Driver** or **CSV files** from the ETL pipeline
- **Data export files** generated by the Python pipeline:
  - `startup_analysis_export.csv`
  - `startup_analysis_export_metadata.json`

---

## ğŸ“ Data Source Configuration

### Option 1: Direct Database Connection (Recommended)

**Step 1: Install PostgreSQL Connector**
1. Open Power BI Desktop
2. Go to **Home** â†’ **Get Data** â†’ **Database** â†’ **PostgreSQL database**
3. Install connector if prompted

**Step 2: Connect to Database**
```
Server: localhost:5432 (or your server address)
Database: startup_analytics
Username: your_username
Password: your_password
```

**Step 3: Select Tables**
Select the following tables:
- âœ… `startups`
- âœ… `funding_rounds`
- âœ… `investors`
- âœ… `financial_metrics`
- âœ… `predictions`
- âœ… `cluster_assignments`
- âœ… `market_indicators`

Click **Load** to import data.

---

### Option 2: CSV File Import

**Step 1: Import Main Dataset**
1. Go to **Home** â†’ **Get Data** â†’ **Text/CSV**
2. Browse to `startup_analysis_export.csv`
3. Power BI will auto-detect data types
4. Click **Transform Data** to open Power Query Editor

**Step 2: Data Type Configuration**
In Power Query Editor, ensure correct data types:
- `startup_id` â†’ Text
- `funding_amount` â†’ Decimal Number
- `valuation` â†’ Decimal Number
- `revenue` â†’ Decimal Number
- `funding_date` â†’ Date
- `growth_potential` â†’ Percentage
- `performance_score` â†’ Decimal Number

**Step 3: Create Date Table (Important!)**
```dax
DateTable = 
CALENDAR(
    DATE(2020, 1, 1),
    DATE(2025, 12, 31)
)
```

Add calculated columns:
```dax
Year = YEAR(DateTable[Date])
Quarter = "Q" & FORMAT(DateTable[Date], "Q")
Month = FORMAT(DateTable[Date], "mmm yyyy")
YearMonth = YEAR(DateTable[Date]) * 100 + MONTH(DateTable[Date])
```

---

## ğŸ”— Creating Relationships

### Relationship Schema

```
startups (1) ----< (*) funding_rounds
startups (1) ----< (*) financial_metrics
startups (1) ----< (*) predictions
startups (1) ----< (*) cluster_assignments

funding_rounds (*) >---- (1) investors (via investments)

DateTable (1) ----< (*) funding_rounds (funding_date)
DateTable (1) ----< (*) market_indicators (indicator_date)
```

### Creating Relationships in Power BI

1. Go to **Model** view
2. Create relationships by dragging:
   - `startups[id]` â†’ `funding_rounds[startup_id]`
   - `startups[id]` â†’ `predictions[startup_id]`
   - `startups[id]` â†’ `cluster_assignments[startup_id]`
3. Set cardinality to **One-to-Many**
4. Set cross-filter direction to **Single** (or **Both** for interactive filtering)

---

## ğŸ“ˆ Key DAX Measures

### Financial Metrics

```dax
Total Funding = 
SUM(funding_rounds[amount_usd])

Average Funding per Startup = 
AVERAGE(funding_rounds[amount_usd])

Total Valuation = 
SUM(startups[current_valuation])

Funding Growth YoY = 
VAR CurrentYear = SUM(funding_rounds[amount_usd])
VAR PreviousYear = 
    CALCULATE(
        SUM(funding_rounds[amount_usd]),
        DATEADD(DateTable[Date], -1, YEAR)
    )
RETURN
    DIVIDE(CurrentYear - PreviousYear, PreviousYear, 0)

Median Funding = 
MEDIANX(
    VALUES(funding_rounds[id]),
    funding_rounds[amount_usd]
)
```

### Performance Metrics

```dax
Average Growth Rate = 
AVERAGE(predictions[predicted_growth_rate])

High Growth Count = 
CALCULATE(
    COUNTROWS(startups),
    cluster_assignments[cluster_name] = "High Growth Stars"
)

Success Rate = 
DIVIDE(
    CALCULATE(COUNTROWS(startups), predictions[success_probability] > 0.7),
    COUNTROWS(startups),
    0
)

Top Performer Flag = 
IF(
    startups[performance_score] >= PERCENTILE.INC(startups[performance_score], 0.9),
    "Top 10%",
    "Others"
)
```

### Cluster Analysis

```dax
Cluster Size = 
CALCULATE(
    COUNTROWS(startups),
    ALLEXCEPT(cluster_assignments, cluster_assignments[cluster_name])
)

Cluster Average Funding = 
CALCULATE(
    AVERAGE(funding_rounds[amount_usd]),
    ALLEXCEPT(cluster_assignments, cluster_assignments[cluster_name])
)
```

### Time Intelligence

```dax
Funding MTD = 
TOTALMTD(
    SUM(funding_rounds[amount_usd]),
    DateTable[Date]
)

Funding QTD = 
TOTALQTD(
    SUM(funding_rounds[amount_usd]),
    DateTable[Date]
)

Deal Count Moving Average (3M) = 
AVERAGEX(
    DATESINPERIOD(DateTable[Date], LASTDATE(DateTable[Date]), -3, MONTH),
    CALCULATE(COUNTROWS(funding_rounds))
)
```

---

## ğŸ¨ Dashboard Design Templates

### Dashboard 1: Executive Overview

**Visuals:**
1. **KPI Cards** (Top Row)
   - Total Startups
   - Total Funding ($)
   - Average Growth Rate (%)
   - Active Investors

2. **Line Chart** - Funding Trends Over Time
   - X-axis: Month/Quarter
   - Y-axis: Total Funding
   - Legend: Funding Round Type

3. **Clustered Bar Chart** - Top 10 Startups by Valuation
   - Y-axis: Startup Name
   - X-axis: Valuation
   - Color: Cluster Name

4. **Donut Chart** - Funding Distribution by Sector
   - Values: Total Funding
   - Legend: Sector

5. **Map** - Geographic Distribution
   - Location: Country/City
   - Size: Total Funding

**Slicers:**
- Date Range
- Sector
- Country
- Funding Stage

---

### Dashboard 2: Cluster Analysis

**Visuals:**
1. **Scatter Chart** - Growth vs Funding
   - X-axis: Funding Amount
   - Y-axis: Growth Rate
   - Legend: Cluster Name
   - Size: Valuation

2. **Table** - Cluster Characteristics
   - Columns: Cluster Name, Count, Avg Funding, Avg Valuation, Avg Growth

3. **Stacked Bar Chart** - Cluster Distribution by Sector
   - Y-axis: Sector
   - X-axis: Count
   - Legend: Cluster Name

4. **Matrix** - Cluster Metrics Deep Dive
   - Rows: Cluster Name
   - Columns: Various metrics (funding, valuation, growth, etc.)

---

### Dashboard 3: Investment Intelligence

**Visuals:**
1. **Waterfall Chart** - Funding Progression
   - Category: Funding Rounds
   - Y-axis: Cumulative Amount

2. **Ribbon Chart** - Sector Evolution Over Time
   - X-axis: Date
   - Y-axis: Funding Amount
   - Series: Sector

3. **Gauge Charts** - Performance Indicators
   - Average Growth Rate
   - Success Probability
   - Market Sentiment

4. **Top N Analysis** - High Potential Targets
   - Filter: Growth Category = "High" AND Success Probability > 70%
   - Columns: Startup, Sector, Predicted Growth, Risk Score

---

### Dashboard 4: Predictive Analytics

**Visuals:**
1. **Line & Clustered Column Chart** - Actual vs Predicted
   - X-axis: Startup Name
   - Columns: Current Valuation
   - Line: Predicted Valuation

2. **Funnel Chart** - Conversion Pipeline
   - Stages: Seed â†’ Series A â†’ Series B â†’ Series C â†’ Exit

3. **Tree Map** - Market Share by Sector
   - Categories: Sector
   - Values: Total Valuation

4. **AI Insights Card** - Key Findings
   - Use Power BI's AI features to auto-generate insights

---

## ğŸ¯ Custom Visuals (Optional)

Install these from the Power BI marketplace:

1. **Sankey Diagram** - Investor flow to startups
2. **Word Cloud** - Sector keywords
3. **Radar Chart** - Startup comparison metrics
4. **Advanced Card** - Enhanced KPI cards
5. **Chiclet Slicer** - Better filtering experience

---

## ğŸ”„ Automatic Refresh Configuration

### Scheduled Refresh (Power BI Service)

1. **Publish to Power BI Service**
   - File â†’ Publish â†’ Select Workspace

2. **Configure Gateway**
   - Settings â†’ Manage Gateways
   - Add PostgreSQL as data source

3. **Set Refresh Schedule**
   - Dataset Settings â†’ Scheduled Refresh
   - Frequency: Daily at 6:00 AM
   - Time zone: Your local time

### Real-time Updates (Advanced)

For near real-time dashboards:

```python
# Python script to push updates to Power BI
from powerbiclient import Report, models
from powerbiclient.authentication import InteractiveLoginAuthentication

auth = InteractiveLoginAuthentication()

# Push data to streaming dataset
dataset_id = "your-dataset-id"
table_name = "RealTimeFunding"

# Push new records
power_bi.post_rows(dataset_id, table_name, new_data)
```

---

## ğŸ” Row-Level Security (RLS)

Restrict data access by user role:

### Create Roles

1. Go to **Modeling** â†’ **Manage Roles**
2. Create roles:

**Role: Sector Analyst**
```dax
[sector] = USERNAME()
```

**Role: Geographic Manager**
```dax
[country] IN {"USA", "Canada"}
```

**Role: Executive** (All Access)
```dax
1=1
```

---

## ğŸš€ Performance Optimization

### Best Practices

1. **Import Mode vs DirectQuery**
   - Use **Import** for better performance
   - Use **DirectQuery** for large datasets

2. **Reduce Data Volume**
   ```dax
   -- Only import last 2 years
   FilteredData = 
   FILTER(
       funding_rounds,
       funding_rounds[funding_date] >= DATE(2023, 1, 1)
   )
   ```

3. **Optimize Columns**
   - Remove unused columns
   - Reduce cardinality where possible
   - Use whole numbers instead of decimals when possible

4. **Aggregations**
   - Pre-aggregate at monthly level for time series
   - Create summary tables for faster queries

---

## ğŸ“± Mobile Dashboard Configuration

### Mobile Layout

1. Go to **View** â†’ **Mobile Layout**
2. Arrange visuals vertically
3. Prioritize:
   - KPI cards at top
   - Most important chart
   - Critical metrics

### Responsive Design Tips
- Use **Card** visuals for mobile
- Limit slicers to 3-4 key filters
- Test on phone view before publishing

---

## ğŸ“ Training Resources

### Learning Path

1. **Power BI Basics** (2 hours)
   - Import data
   - Create basic visuals
   - Publish reports

2. **DAX Fundamentals** (4 hours)
   - Calculated columns vs measures
   - Context (row vs filter)
   - Time intelligence

3. **Advanced Techniques** (6 hours)
   - Complex DAX patterns
   - Performance optimization
   - Custom visuals

### Recommended Courses
- Microsoft Learn: Power BI Data Analyst
- SQLBI: DAX Patterns
- Guy in a Cube: YouTube Channel

---

## ğŸ†˜ Troubleshooting

### Common Issues

**Issue: Relationships not working**
- âœ… Check data types match (Text to Text, Number to Number)
- âœ… Ensure no null values in key columns
- âœ… Verify cardinality is correct

**Issue: Slow performance**
- âœ… Reduce data volume (filter to recent dates)
- âœ… Remove calculated columns, use measures instead
- âœ… Disable auto date/time tables

**Issue: Incorrect calculations**
- âœ… Check filter context
- âœ… Use CALCULATE() to modify context
- âœ… Add visual filters to debug

---

## ğŸ“§ Support

For technical support:
- GitHub Issues: [your-repo]/issues
- Email: analytics-support@yourcompany.com
- Slack: #data-analytics

---

## âœ… Checklist

Before going live:

- [ ] All data sources connected
- [ ] Relationships configured
- [ ] DAX measures tested
- [ ] Dashboards designed
- [ ] Row-level security implemented
- [ ] Refresh schedule configured
- [ ] Mobile layout optimized
- [ ] User training completed
- [ ] Documentation shared

---

**Last Updated:** November 2024  
**Version:** 1.0  
**Author:** Analytics Team
